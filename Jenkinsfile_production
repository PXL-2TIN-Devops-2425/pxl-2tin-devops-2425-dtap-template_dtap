#!/usr/bin/env groovy
pipeline {
    agent any

    stages {
        stage('cleanup') {

            steps {

               cleanWs()

           }
       }


        stage('Start prod'){
            steps{
                sshagent(credentials: ['devops_aws']) {

                    sh 'ssh ec2-user@54.90.179.147 docker pull theinstant/calculator'
                    sh 'ssh ec2-user@54.90.179.147 docker run -dt --name calculator -p 80:3000 theinstant/calculator'

                }
            }
        }
    }

}
